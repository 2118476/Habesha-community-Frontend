<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Notification System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f0f0f0;
        }
        
        .debug-panel {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .test-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        .test-btn:hover {
            background: #0056b3;
        }
        
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        /* Notification System Styles */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            max-width: 400px;
            pointer-events: none;
        }
        
        .notification {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            cursor: pointer;
            pointer-events: auto;
            transition: all 0.2s ease;
            position: relative;
        }
        
        .notification:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }
        
        .notification-title {
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .notification-message {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .notification-actions {
            display: flex;
            gap: 8px;
        }
        
        .notification-action {
            padding: 4px 8px;
            border: 1px solid #007bff;
            background: #007bff;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .notification-action:hover {
            background: #0056b3;
        }
        
        .notification-dismiss {
            position: absolute;
            top: 8px;
            right: 8px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="debug-panel">
        <h1>Notification System Debug</h1>
        <p>This page tests the notification onClick functionality step by step.</p>
        
        <div>
            <button class="test-btn" onclick="testBasicNotification()">Test Basic Notification</button>
            <button class="test-btn" onclick="testNotificationWithClick()">Test with onClick</button>
            <button class="test-btn" onclick="testNotificationWithActions()">Test with Actions</button>
            <button class="test-btn" onclick="clearAll()">Clear All</button>
        </div>
        
        <h3>Debug Log:</h3>
        <div id="log" class="log">Ready to test...\n</div>
    </div>
    
    <div id="notification-container" class="notification-container"></div>
    
    <script>
        let notificationId = 1;
        
        function log(message) {
            const logEl = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logEl.textContent += `[${timestamp}] ${message}\n`;
            logEl.scrollTop = logEl.scrollHeight;
            console.log(`[Debug] ${message}`);
        }
        
        function clearAll() {
            document.getElementById('notification-container').innerHTML = '';
            document.getElementById('log').textContent = 'Log cleared...\n';
        }
        
        function createNotification(config) {
            const container = document.getElementById('notification-container');
            const id = notificationId++;
            
            log(`Creating notification #${id}: "${config.title}"`);
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.dataset.id = id;
            
            let actionsHtml = '';
            if (config.actions) {
                actionsHtml = '<div class="notification-actions">';
                config.actions.forEach((action, index) => {
                    actionsHtml += `<button class="notification-action" onclick="handleAction(${id}, ${index}, event)">${action.label}</button>`;
                });
                actionsHtml += '</div>';
            }
            
            notification.innerHTML = `
                <button class="notification-dismiss" onclick="dismissNotification(${id}, event)">×</button>
                <div class="notification-title">${config.title}</div>
                <div class="notification-message">${config.message}</div>
                ${actionsHtml}
            `;
            
            // Add click handler
            if (config.onClick) {
                log(`Adding onClick handler to notification #${id}`);
                notification.addEventListener('click', function(e) {
                    // Don't trigger if clicking on buttons
                    if (e.target.tagName === 'BUTTON') {
                        log(`Click on button ignored for notification #${id}`);
                        return;
                    }
                    
                    log(`Notification #${id} clicked - executing onClick handler`);
                    config.onClick({
                        id: id,
                        title: config.title,
                        message: config.message
                    });
                });
            } else {
                log(`No onClick handler for notification #${id}`);
            }
            
            container.appendChild(notification);
            
            // Store action handlers
            if (config.actions) {
                notification._actionHandlers = config.actions.map(action => action.onClick);
            }
            
            log(`Notification #${id} created and added to DOM`);
            
            // Auto-dismiss after 10 seconds
            setTimeout(() => {
                dismissNotification(id);
            }, 10000);
            
            return id;
        }
        
        function dismissNotification(id, event) {
            if (event) {
                event.stopPropagation();
            }
            
            const notification = document.querySelector(`[data-id="${id}"]`);
            if (notification) {
                log(`Dismissing notification #${id}`);
                notification.style.transform = 'translateX(100%)';
                notification.style.opacity = '0';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }
        }
        
        function handleAction(notificationId, actionIndex, event) {
            event.stopPropagation();
            log(`Action #${actionIndex} clicked on notification #${notificationId}`);
            
            const notification = document.querySelector(`[data-id="${notificationId}"]`);
            if (notification && notification._actionHandlers && notification._actionHandlers[actionIndex]) {
                notification._actionHandlers[actionIndex]({
                    notificationId: notificationId,
                    actionIndex: actionIndex
                });
            }
            
            // Auto-dismiss after action
            setTimeout(() => {
                dismissNotification(notificationId);
            }, 1000);
        }
        
        // Test functions
        function testBasicNotification() {
            log('Testing basic notification (no onClick)...');
            createNotification({
                title: 'Basic Notification',
                message: 'This is a basic notification without onClick handler.'
            });
        }
        
        function testNotificationWithClick() {
            log('Testing notification with onClick...');
            createNotification({
                title: 'Clickable Notification',
                message: 'Click anywhere on this notification to test the onClick handler!',
                onClick: function(notification) {
                    log(`SUCCESS: onClick handler executed for notification #${notification.id}`);
                    alert(`✅ onClick worked! Notification: ${notification.title}`);
                }
            });
        }
        
        function testNotificationWithActions() {
            log('Testing notification with action buttons...');
            createNotification({
                title: 'Notification with Actions',
                message: 'This notification has action buttons. Try clicking them!',
                onClick: function(notification) {
                    log(`SUCCESS: Main onClick handler executed for notification #${notification.id}`);
                    alert(`✅ Main onClick worked! Notification: ${notification.title}`);
                },
                actions: [
                    {
                        label: 'Accept',
                        onClick: function(data) {
                            log(`SUCCESS: Accept action executed`);
                            alert('✅ Accept action worked!');
                        }
                    },
                    {
                        label: 'Decline',
                        onClick: function(data) {
                            log(`SUCCESS: Decline action executed`);
                            alert('✅ Decline action worked!');
                        }
                    }
                ]
            });
        }
        
        log('Debug page loaded and ready for testing');
    </script>
</body>
</html>